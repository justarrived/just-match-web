<form
  (ngSubmit)="onSubmit()"
  #form="ngForm"
  class="ui form">
  <sm-loader
    [complete]="!loadingSubmit"
    class="inverted"
    text="{{'component.loading' | translate}}">
  </sm-loader>

  <h3 class="ui horizontal divider pink header">
    <i class="user icon"></i>
    Personal presentation
  </h3>

  <description-input
    [apiErrors]="apiErrors"
    [control]="profileForm.controls['description']">
  </description-input>

  <h3 class="ui horizontal divider pink header">
    <i class="id card icon"></i>
    Status
  </h3>

  <status-input
    [apiErrors]="apiErrors"
    [control]="profileForm.controls['current_status']">
  </status-input>

  <at-und-input
    [apiErrors]="apiErrors"
    [control]="profileForm.controls['at_und']"
    *ngIf="profileForm.value.current_status === 'asylum_seeker'">
  </at-und-input>

  <got-coordination-number-input
    [apiErrors]="apiErrors"
    [control]="profileForm.controls['got_coordination_number']"
    *ngIf="profileForm.value.current_status === 'asylum_seeker' && profileForm.value.at_und === 'yes'">
  </got-coordination-number-input>

  <ssn-input
    [apiErrors]="apiErrors"
    [control]="profileForm.controls['ssn']"
    *ngIf="profileForm.value.current_status && ((profileForm.value.current_status === 'asylum_seeker' && profileForm.value.at_und === 'yes' && profileForm.value.got_coordination_number === 'yes') || (profileForm.value.current_status !== 'asylum_seeker'))">
  </ssn-input>

  <lma-card-input
    [centered]="true"
    [user]="user"
    [showLabel]="true"
    *ngIf="profileForm.value.current_status === 'asylum_seeker' && profileForm.value.at_und === 'yes'">
  </lma-card-input>

  <personal-id-input
    [centered]="true"
    [user]="user"
    [showLabel]="true"
    *ngIf="profileForm.value.current_status !== 'asylum_seeker'">
  </personal-id-input>

  <residence-permit-front-input
    [centered]="true"
    [user]="user"
    [showLabel]="true"
    *ngIf="profileForm.value.current_status === 'temporary_residence' || profileForm.value.current_status === 'permanent_residence'">
  </residence-permit-front-input>

  <residence-permit-back-input
    [centered]="true"
    [user]="user"
    [showLabel]="true"
    *ngIf="profileForm.value.current_status === 'temporary_residence' || profileForm.value.current_status === 'permanent_residence'">
  </residence-permit-back-input>

  <work-permit-front-input
    [centered]="true"
    [user]="user"
    [showLabel]="true"
    *ngIf="profileForm.value.current_status === 'student_visa' || profileForm.value.current_status === 'temporary_residence'">
  </work-permit-front-input>

  <work-permit-back-input
    [centered]="true"
    [user]="user"
    [showLabel]="true"
    *ngIf="profileForm.value.current_status === 'student_visa' || profileForm.value.current_status === 'temporary_residence'">
  </work-permit-back-input>

  <skatteverket-certificate-input
    [centered]="true"
    [user]="user"
    [showLabel]="true"
    *ngIf="profileForm.value.current_status === 'eu_citizen' || profileForm.value.current_status === 'asylum_seeker' && profileForm.value.at_und === 'yes' && profileForm.value.got_coordination_number === 'yes'">
  </skatteverket-certificate-input>

  <h3 class="ui horizontal divider pink header">
    <i class="world icon"></i>
    Language skills
  </h3>

  <languages-input
    [languagesControl]="profileForm.controls['languages']"
    [userLanguagesControl]="profileForm.controls['user_languages']"
    [apiErrors]="apiErrors">
  </languages-input>

  <h3 class="ui horizontal divider pink header">
    <i class="rocket icon"></i>
    General skills
  </h3>

  <competence-input
    [control]="profileForm.controls['competence_text']"
    [apiErrors]="apiErrors">
  </competence-input>

  <skills-input
    [skillsControl]="profileForm.controls['skills']"
    [userSkillsControl]="profileForm.controls['user_skills']"
    [apiErrors]="apiErrors">
  </skills-input>

  <h3 class="ui horizontal divider pink header">
    <i class="thumbs up icon"></i>
    Fields of interest
  </h3>

  <h3 class="ui horizontal divider pink header">
    <i class="student icon"></i>
    Education
  </h3>

  <education-input
    [apiErrors]="apiErrors"
    [control]="profileForm.controls['education']">
  </education-input>

  <h3 class="ui horizontal divider pink header">
    <i class="suitcase icon"></i>
    Experience
  </h3>

  <job-experience-input
    [control]="profileForm.controls['job_experience']"
    [apiErrors]="apiErrors">
  </job-experience-input>

  <div class="field">
    <label>
      {{'user.profile.form.resume.label' | translate}}
    </label>
  </div>

  <div class="profile-form-input-container">
    <div class="profile-form-upload-image-container">
      <loading *ngIf="resumeDocumentStatusObject.uploadingDocument"></loading>

      <input *ngIf="!resumeDocumentStatusObject.uploadingDocument"
          type="file" id="resume-document-filename"
          name="resume-document-filename"
          class="profile-form-upload-image-input"
          (change)="onDocumentFilenameChange($event, 'cv', resumeDocumentStatusObject)">

      <label *ngIf="!resumeDocumentStatusObject.uploadingDocument"
          for="resume-document-filename"
          class="profile-form-upload-image-button btn-secondary btn-small btn btn-image-upload">{{'user.profile.form.resume.upload.button' | translate}}</label>
      <p class="profile-form-upload-image-description">{{'user.profile.form.resume.upload.description' | translate}}</p>
      <div *ngIf="resumeDocumentStatusObject.documentSaveSuccess" class="profile-form-save-message">{{'user.profile.form.resume.upload.success' | translate}}</div>
      <div *ngIf="resumeDocumentStatusObject.documentSaveFail" class="profile-form-error-message">{{'user.profile.form.resume.upload.fail' | translate}}</div>

      <p *ngIf="user.cvDocuments.length > 0">
        <em>{{'user.profile.form.resume.list.title' | translate}}</em>
      </p>
      <div *ngFor="let document of user.cvDocuments">
        <a href="{{document.documentUrl}}" target="_blank">
          <i class="fa fa-file-text"></i> {{document.createdAt | date: 'yyyy-MM-dd HH:mm'}}
        </a>
      </div>
    </div>
  </div>

  <form-submit-button
    [submitFail]="submitFail"
    [submitSuccess]="submitSuccess"
    [buttonText]="'user.profile.form.submit.button' | translate">
  </form-submit-button>
</form>
