<div class="user-details-container">
  <div class="user-details-form-container">

    <form #form="ngForm" class="ui form" (ngSubmit)="onSubmit()">
      <sm-loader [complete]="!loadingSubmit" class="inverted" text="{{'component.loading' | translate}}"></sm-loader>

      <div class="user-details-form-group-title">{{'user.settings.form.personal.info.header' | translate}}</div>

      <div class="field">
        <sm-input
          [control]="settingsForm.controls['first_name']"
          [label]="('user.settings.form.first.name.label' | translate) + ' *'"
          [placeholder]="'user.register.form.first.name.placeholder' | translate"
          class="left"
          icon="user"
          type="text">
        </sm-input>
        <input-errors attribute="first_name" [controls]="settingsForm.controls" [apiErrors]="apiErrors"></input-errors>
      </div>

      <div class="field">
        <sm-input
          [control]="settingsForm.controls['last_name']"
          [label]="('user.settings.form.last.name.label' | translate) + ' *'"
          [placeholder]="'user.settings.form.last.name.placeholder' | translate"
          class="left"
          icon="user"
          type="text">
        </sm-input>
        <input-errors attribute="last_name" [controls]="settingsForm.controls" [apiErrors]="apiErrors"></input-errors>
      </div>

      <div class="field">
        <sm-input
          [control]="settingsForm.controls['email']"
          [label]="('user.settings.form.email.label' | translate) + ' *'"
          [placeholder]="'user.settings.form.email.placeholder' | translate"
          class="left"
          icon="mail"
          type="email">
        </sm-input>
        <input-errors
          attribute="email"
          [patternLabel]="'validations.email_pattern' | translate"
          [controls]="settingsForm.controls"
          [apiErrors]="apiErrors">
        </input-errors>
      </div>

      <div class="field">
        <sm-input
          [control]="settingsForm.controls['phone']"
          [label]="('user.settings.form.phone.label' | translate) + ' *'"
          [placeholder]="'user.settings.form.phone.placeholder' | translate"
          class="left"
          icon="phone"
          type="text">
        </sm-input>
        <input-errors attribute="phone" [controls]="settingsForm.controls" [apiErrors]="apiErrors"></input-errors>
      </div>

      <hr>

      <div class="user-details-form-group-title">{{'user.settings.form.address.header' | translate}}</div>

      <div class="field">
        <sm-input
          [control]="settingsForm.controls['street']"
          [label]="'user.register.form.street.header' | translate"
          [placeholder]="'user.register.form.street.placeholder' | translate"
          class="left"
          icon="map pin"
          type="text">
        </sm-input>
        <input-errors attribute="street" [controls]="settingsForm.controls" [apiErrors]="apiErrors"></input-errors>
      </div>

      <div class="field">
        <sm-input
          [control]="settingsForm.controls['zip']"
          [label]="'user.register.form.zip.header' | translate"
          [placeholder]="'user.register.form.zip.placeholder' | translate"
          class="left"
          icon="map"
          type="text">
        </sm-input>
        <input-errors attribute="zip" [controls]="settingsForm.controls" [apiErrors]="apiErrors"></input-errors>
      </div>

      <div class="field">
        <sm-input
          [control]="settingsForm.controls['city']"
          [label]="'user.register.form.city.header' | translate"
          [placeholder]="'user.register.form.city.placeholder' | translate"
          class="left"
          icon="building"
          type="text">
        </sm-input>
        <input-errors attribute="city" [controls]="settingsForm.controls" [apiErrors]="apiErrors"></input-errors>
      </div>

      <hr>

      <div class="user-details-form-group-title">{{'user.settings.form.change.password.header' | translate}}</div>

      <div class="field">
        <sm-input
          [control]="passwordForm.controls['old_password']"
          [label]="'user.settings.form.new.password.label' | translate"
          [placeholder]="'user.settings.form.old.password.placeholder' | translate"
          class="left"
          icon="lock"
          type="password">
        </sm-input>
        <sm-input
          [control]="passwordForm.controls['password']"
          [label]="'user.settings.form.new.password.label' | translate"
          [placeholder]="'user.settings.form.new.password.placeholder' | translate"
          class="left"
          icon="lock"
          type="password">
        </sm-input>
        <sm-input
          [control]="passwordForm.controls['repeat_password']"
          [label]="'user.settings.form.new.password.label' | translate"
          [placeholder]="'user.settings.form.repeat.password.placeholder' | translate"
          class="left"
          icon="lock"
          type="password">
        </sm-input>
        <input-errors attribute="password" [controls]="passwordForm.controls" [apiErrors]="apiErrors"></input-errors>
        <input-error
          [visible]="passwordsSuppliedAndMisMatch()"
          [label]="'user.settings.form.repeat.password.validation.mismatch' | translate">
        </input-error>
      </div>

      <hr class="user-details-form-ruler">

      <div class="user-details-form-group-title">{{'user.settings.form.bank.details.header' | translate}}</div>

      <div class="field">
        <sm-input
          [control]="settingsForm.controls['account_clearing_number']"
          [label]="'user.settings.form.clearing.number.label' | translate"
          [placeholder]="'user.settings.form.clearing.number.placeholder' | translate"
          class="left"
          type="text">
        </sm-input>
        <input-errors attribute="account_clearing_number" [controls]="settingsForm.controls" [apiErrors]="apiErrors"></input-errors>
      </div>

      <div class="field">
        <sm-input
          [control]="settingsForm.controls['account_number']"
          [label]="'user.settings.form.account.number.label' | translate"
          [placeholder]="'user.settings.form.account.number.placeholder' | translate"
          class="left"
          type="text">
        </sm-input>
        <input-errors attribute="account_number" [controls]="settingsForm.controls" [apiErrors]="apiErrors"></input-errors>
        <!-- The API can return errors for account, which isn't bound to any instance of form control -->
        <api-errors [errors]="apiErrors" attribute="account"></api-errors>
      </div>

      <div class="user-details-form-button-container">
        <div *ngIf="saveFail" class="user-details-form-error-message">{{'user.settings.form.submit.fail' | translate}}</div>
        <div *ngIf="saveSuccess" class="user-details-form-save-message">{{'user.settings.form.submit.success' | translate}}</div>
        <button class="user-details-form-button" *ngIf="!loadingSubmit" type="submit" class="btn-primary btn-small btn">{{'user.settings.form.submit.button' | translate}}</button>
      </div>
    </form>
  </div>
</div>
